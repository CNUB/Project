# Mbed OS 기반 스마트 도어락

## 1. 프로젝트 개요

이 프로젝트는 Mbed OS를 기반으로 제작된 스마트 도어락 시스템입니다. 사용자는 비밀번호, 수동 버튼, 또는 블루투스 통신을 통해 문을 열고 닫을 수 있습니다. 현재 도어락의 상태와 실내 온습도 정보는 OLED 디스플레이에 실시간으로 표시됩니다.

## 2. 주요 기능

- **다중 제어 방식**: 비밀번호(조이스틱 입력), 물리 버튼, 블루투스 원격 명령으로 문 제어 가능
- **상태 표시**: OLED 디스플레이를 통해 문 개폐 상태(Open/Closed) 및 실내 온습도 정보 제공
- **사용자 피드백**: 문이 열리거나 닫힐 때 부저음으로 상태 변화 알림
- **보안 기능**: 조이스틱을 이용한 비밀번호 입력 및 변경 기능

## 3. 사용된 하드웨어

| 부품/모듈 | 모델/종류 | 연결 핀 |
| :--- | :--- | :--- |
| **MCU 보드** | ST NUCLEO (예: NUCLEO-F446RE) | - |
| **온습도 센서** | DHT22 | `PB_2` |
| **OLED 디스플레이** | SSD1306 (I2C) | `I2C_SDA`, `I2C_SCL` |
| **블루투스 모듈** | HC-05 / HC-06 | `PA_11`(TX), `PA_12`(RX) |
| **DC 모터** | 일반 DC 모터 | 모터 드라이버에 연결 |
| **모터 드라이버** | - | `PA_7`, `PC_8` |
| **아날로그 조이스틱**| - | `PC_2`(X축), `PC_3`(Y축) |
| **피에조 부저** | - | `PC_9` |
| **LED** | 초록색 LED | `PA_13` |
| | 노란색 LED | `PB_10` |
| | 빨간색 LED | `PA_4` |
| **버튼** | Tactile Switch | `button_input.h` 참조 |

## 4. 빌드 및 실행 방법

이 프로젝트는 **Mbed Studio** 또는 **Mbed CLI**를 사용하여 빌드할 수 있습니다.

### Mbed Studio 사용 시

1. Mbed Studio를 실행하고 이 프로젝트 폴더를 엽니다.
2. NUCLEO 보드를 PC에 연결합니다.
3. Mbed Studio가 자동으로 보드를 인식하고 대상을 설정합니다.
4. **Build** 버튼을 클릭하여 프로젝트를 컴파일합니다.
5. **Run** 버튼을 클릭하여 컴파일된 펌웨어를 보드에 업로드하고 실행합니다.

### Mbed CLI 사용 시

```bash
# 1. Mbed 프로젝트로 초기화 (최초 1회)
mbed new .

# 2. 컴파일 대상 보드 설정 (예: NUCLEO_F446RE)
mbed target NUCLEO_F446RE

# 3. 툴체인 설정 (예: GCC_ARM)
mbed toolchain GCC_ARM

# 4. 프로젝트 빌드
mbed compile

# 5. 빌드된 펌웨어를 보드로 복사
# (BUILD/NUCLEO_F446RE/GCC_ARM/smart-doorlock.bin 파일을
#  NUCLEO 드라이브로 드래그 앤 드롭)
```

## 5. 소스 코드 구조

- `main.cpp`: 메인 로직 및 상태 머신 구현
- `motordriver.h/.cpp`: DC 모터 제어 함수
- `pw_mode.h/.cpp`: 비밀번호 입력 및 관리 기능
- `button_input.h`: 버튼 입력 처리
- `Adafruit_GFX/`, `DHT/`: 외부 라이브러리
